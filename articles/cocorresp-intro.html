<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to Co-correspondence Analysis • cocorresp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to Co-correspondence Analysis">
<meta property="og:description" content="cocorresp">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cocorresp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4-2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/cocorresp-intro.html">Introduction to Co-correspondence Analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/gavinsimpson/cocorresp/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to Co-correspondence Analysis</h1>
                        <h4 class="author">Gavin L. Simpson</h4>
            
            <h4 class="date">2020-06-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/gavinsimpson/cocorresp/blob/master/vignettes/cocorresp-intro.Rmd"><code>vignettes/cocorresp-intro.Rmd</code></a></small>
      <div class="hidden name"><code>cocorresp-intro.Rmd</code></div>

    </div>

    
    
<p>Among the ordination methods available to ecologists there are methods that relate a species abundance or occurrence matrix to a matrix of explanatory variables. Known as constrained or canonical ordination methods, redundancy analysis (RDA) and Canonical Correspondence Analysis (CCA) are the most commonly encountered forms. A restriction of these methods is that they are only constrained if there are fewer explanatory variables as numbers of observations or species, whichever is lowest, - 1.</p>
<p>Relating two species matrices is not possible using RDA or CCA unless the number of species in the data set playing the explanatory role is much smaller than the number of observations. Co-inertia analysis was invented as a solution to problems of this sort, but a deficiency is that it has an underlying linear response model like RDA.</p>
<p>Co-correspondence analysis (Co-CA) combines the ideas of co-inertia analysis with the unimodal response model familiar to correspondence analysis (CA) or CCA methods. The aim is to related two species abundance or occurrence matrices such that the resulting decomposition into axes are those combinations that best explain the covariation between species and observations in the two matrices.</p>
<p>There are two forms of Co-CA;</p>
<ol style="list-style-type: decimal">
<li>Symmetric Co-CA, and</li>
<li>Predictive Co-CA.</li>
</ol>
<p>In symmetric Co-CA, neither of the two abundance or occurrence matrices plays the predictive or explanatory role. This method is best thought of as identifying the common patterns between the two assemblages. In contrast, in predictive Co-CA a more direct regression model is fitted where one matrix plays the response role and the other the predictor role. In this way, one set of species data is used to predict the other.</p>
<p>The key requirement for Co-CA is that the two assemblages have been collected at the same locations, just as you would if you wanted to explain species abundance as a function of environmental factors.</p>
<div id="symmetric-co-ca" class="section level2">
<h2 class="hasAnchor">
<a href="#symmetric-co-ca" class="anchor"></a>Symmetric Co-CA</h2>
<p>As an illustration of symmetric Co-CA, we look at common patterns in a data set of beetles and plants. The data are provided with <strong>cocorresp</strong></p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">beetles</span>)
<span class="co">## log transform the beetle data</span>
<span class="no">beetles</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log1p</a></span>(<span class="no">beetles</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">plants</span>)</pre></body></html></div>
<p>The data are observations of beetle and vascular plant species abundance at 30 roadside verges in the Netherlands. There are 126 beetle taxa and 231 vascular plant species. The abundances of the vascular plants are recorded on the 1–9 van der Maarel scale. To make the distributions of beetle species abundances more symmetric and stabilise variances, the counts are log transformed.</p>
<p>Both forms of Co-CA are fitted using the <code><a href="../reference/coca.html">coca()</a></code> function. The call comprises</p>
<ol style="list-style-type: decimal">
<li>a formula, where the left-hand side is a community data frame or matrix, and the right-hand side is typically a <code>.</code>,</li>
<li>a <code>data</code> argument supplied a suitable data frame or matrix. This is the object used to form the terms on the right-hand side of the formula indicated by the <code>.</code> placeholder,</li>
<li>the type of Co-CA model to fit, indicated by the <code>method</code> argument; options are <code>"symmetric"</code> and <code>"predictive"</code>.</li>
</ol>
<p>A symmetric Co-CA is fitted to the beetle and plant data sets as follows</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">bp.sym</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/coca.html">coca</a></span>(<span class="no">beetles</span> ~ <span class="no">.</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">plants</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"symmetric"</span>)</pre></body></html></div>
<pre><code>## 
## Removed some species that contained no data in: beetles, plants</code></pre>
<p>Notice that it shouldn’t make any difference which of the matrices is specified on the right- or left-hand sides of the formula. The messages printing during fitting are for information; some species contained no data and hence were removed prior to fitting. This data processing step could have been performed ahead of time via</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">beetles</span> <span class="kw">&lt;-</span> <span class="no">beetles</span>[, <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span>(<span class="no">beetles</span>) <span class="kw">&gt;</span> <span class="fl">0</span>]
<span class="no">plants</span> <span class="kw">&lt;-</span> <span class="no">plants</span>[, <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span>(<span class="no">plants</span>) <span class="kw">&gt;</span> <span class="fl">0</span>]
<span class="no">bp.sym</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/coca.html">coca</a></span>(<span class="no">beetles</span> ~ <span class="no">.</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">plants</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"symmetric"</span>)</pre></body></html></div>
<p>Printing the resulting object provides a relatively compact summary of the Co-CA model fitted</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">bp.sym</span></pre></body></html></div>
<pre><code>## 
## Symmetric Co-Correspondence Analysis
## 
## Call: symcoca(y = y, x = x, n.axes = n.axes, R0 = weights, symmetric =
## symmetric, nam.dat = nam.dat)
## 
## Inertia:
##          Total Explained Residual
## beetles: 3.988     3.971    0.018
## plants:  5.757     5.740    0.018</code></pre>
<p>A screeplot provides a graphical summary of the dimensionality of the covariance between the two matrices.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html">screeplot</a></span>(<span class="no">bp.sym</span>)</pre></body></html></div>
<p><img src="cocorresp-intro_files/figure-html/screeplot-symcoca-1.png" width="700"></p>
<p>From the screeplot, we see that most of the signal in the covariance is contained on the first 2–3 axes.</p>
<p>The resulting symmetric co-correspondence analysis can be plotted in the form of a biplot, except now we have two sets of species (variable) scores and two sets of site (observations or sample) scores. The <code>biplot</code> method can be used to draw Co-CA biplots. The <code>which</code> argument selects which of the two assemblages are drawn:</p>
<ul>
<li>
<code>"y1"</code> indicates the species assemblage on the left-hand side of the formula,</li>
<li>
<code>"y2"</code> indicates the species assemblage on the right-hand side of the formula.</li>
</ul>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fl">1</span>:<span class="fl">2</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">2</span>))
<span class="fu"><a href="https://rdrr.io/r/stats/biplot.html">biplot</a></span>(<span class="no">bp.sym</span>, <span class="kw">which</span> <span class="kw">=</span> <span class="st">"y1"</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Beetles"</span>)
<span class="fu"><a href="https://rdrr.io/r/stats/biplot.html">biplot</a></span>(<span class="no">bp.sym</span>, <span class="kw">which</span> <span class="kw">=</span> <span class="st">"y2"</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"Plants"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span>(<span class="fl">1</span>)</pre></body></html></div>
<p><img src="cocorresp-intro_files/figure-html/plot-symcoca-1.png" width="1344"></p>
<p>Some additional control is afforded by the <code><a href="https://rdrr.io/r/base/plot.html">plot()</a></code> method, but good plots of the fitted Co-CA will often require the use of lower-level functions such as the <code><a href="https://rdrr.io/r/graphics/points.html">points()</a></code> and <code>scores()</code> methods, as well as using appropriate sets of scores or loadings.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Gavin L. Simpson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
