<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Permutation test for predictive co-correspondence analysis models — permutest.coca • cocorresp</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Permutation test for predictive co-correspondence analysis models — permutest.coca"><meta property="og:description" content="A permutation test for predictive co-correspondence analysis models to
  assess the significance of each CoCA ordination axes."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cocorresp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4-5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/cocorresp-intro.html">Introduction to Co-correspondence Analysis</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/gavinsimpson/cocorresp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Permutation test for predictive co-correspondence analysis models</h1>

    <div class="hidden name"><code>permutest.coca.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A permutation test for predictive co-correspondence analysis models to
  assess the significance of each CoCA ordination axes.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre><code># S3 method for class 'coca'
permutest(x, R0 = NULL, permutations = 99,
               n.axes = x$n.axes, verbose = TRUE, ...)

&lt;!-- %\method{print}{permutest.coca}(x, digits = max(3, getOption("digits") - 3), \ldots) --&gt;

# S3 method for class 'permutest.coca'
summary(object, ...)

&lt;!-- %\method{print}{summary.permutest.coca}(x, digits = max(3, getOption("digits") - 3), \ldots) --&gt;</code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>an object of class <code>"predcoca"</code>.</p></dd>

  <dt id="arg-r-">R0<a class="anchor" aria-label="anchor" href="#arg-r-"></a></dt>
<dd><p>row weights to use in the analysis. If missing, the
    default, these are determined from <code>x</code>.</p></dd>

  <dt id="arg-permutations">permutations<a class="anchor" aria-label="anchor" href="#arg-permutations"></a></dt>
<dd><p>the number of permutations to perform.</p></dd>

  <dt id="arg-n-axes">n.axes<a class="anchor" aria-label="anchor" href="#arg-n-axes"></a></dt>
<dd><p>The number of axes to test. Defaults to the number of
    axes stated in <code>x$n.axes</code>.</p></dd>

  <dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>if <code>TRUE</code>, the default, print information on the
    progress of the permutation test procedure.</p></dd>

  <dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>an object of class <code>"permutest.coca"</code>.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>arguments to be passed to other methods.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>An alternative approach to cross-validation (see
  <code><a href="crossval.html">crossval</a></code>) to select the number of axes to retain in a
  predictive co-correspondence analysis is to test the statistical
  significance of each ordination axis using permutation tests.</p>
<p>The test statistic used is the <em>F</em>-ratio based on the fit of the
  first axis to the response data (ter Braak and Smilauer 2002). The
  second and subsequent axes are tested by treating previous axes as
  co-variables.</p>
<p>To be precise, this approach does not test the significance of SIMPLS
  axes, but those of NIPALS-PLS axes (ter Braak and de Jong 1998).</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>A list with the following components:</p>
<dl><dt>pval </dt>
<dd><p>a vector of <em>P</em>-values for each ordination axis.</p></dd>

  <dt>permstat </dt>
<dd><p>a vector of values for the test statistic for each axis.</p></dd>

  <dt>total.inertia </dt>
<dd><p>the total inertia in the response matrix.</p></dd>

  <dt>inertia </dt>
<dd><p>a vector containing the <em>residualised</em>
    inertia. This is the total inertia in the response <em>after</em>
    removing the inertia explained by all previous axes. For the first
    CoCA axis this is, by definition, the total inertia in the
    response.</p></dd>

  <dt>fitax </dt>
<dd><p>a vector containing the amount of inertia in the
    response matrix explained by each ordination axis.</p></dd>

  <dt>pcent.fit </dt>
<dd><p>a vector containing the fit of each axis to the
    response as a percentage of the total inertia (variance).</p></dd>

  <dt>n.axes </dt>
<dd><p>the number of axes in the ordination.</p></dd>

  <dt>call </dt>
<dd><p>the matched call.</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>


<p>ter Braak, C.J.F. and de Jong, S. (1998) The objective function of
  partial least squares regression. <em>Journal of Chemometrics</em>
  <b>12</b>, 41–54.</p>
<p>ter Braak, C.J.F and Schaffers, A.P. (2004) Co-Correspondence
  Analysis: a new ordination method to relate two community
  compositions. <em>Ecology</em> <b>85(3)</b>, 834–846.</p>
<p>ter Braak, C.J.F. and Smilauer, P. (2002) <em>Canoco reference manual
    and CanoDraw for Windows user's guide: software for canonical
    community ordination. Version 4.5</em>. New York: Microcomputer Power.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Gavin L. Simpson, based on Matlab code by C.J.F. ter Braak and
  A.P. Schaffers.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Argument <code>R0</code> is provided for compatibility with the original
  MATLAB code. The R usage paradigm makes this argument redundant in the
  current code and it may be invalid to supply different row weights
  (\(R_0\)) as <code>R0</code>. This argument will likely be removed in future
  versions.</p>
    </div>
    <div id="warning">
    <h2>Warning</h2>
    <p>This function is <b>slow</b>. Beware setting argument
  <code>permutations</code> higher than the default. Determine how long it
  takes for the default 99 permutations to complete before going crazy
  and asking for thousands of permutations - you've been warned, have a
  good book to hand.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="coca.html">coca</a></code>, for the model fitting function,
  <code><a href="crossval.html">crossval</a></code>, for a leave-one-out cross-validation
  procedure, which is the preferred way to select axes in a predictive
  co-correspondence analysis.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## load some data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">beetles</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">plants</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## log transform the bettle data</span></span></span>
<span class="r-in"><span><span class="va">beetles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">beetles</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## predictive CoCA using SIMPLS and formula interface</span></span></span>
<span class="r-in"><span><span class="va">bp.pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="coca.html">coca</a></span><span class="op">(</span><span class="va">beetles</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">plants</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Removed some species that contained no data in: beetles, plants </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## should retain only the useful PLS components for a parsimonious model</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">## Leave-one-out crossvalidation - this takes a while</span></span></span>
<span class="r-in"><span><span class="fu"><a href="crossval.html">crossval</a></span><span class="op">(</span><span class="va">beetles</span>, <span class="va">plants</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> some species contain no data and were removed from data matrix y</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> some species contain no data and were removed from data matrix x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 1 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 2 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 3 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 4 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 5 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 6 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 7 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 8 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 9 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 10 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 11 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 12 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 13 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 14 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 15 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 16 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 17 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 18 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 19 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 20 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 21 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 22 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 23 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 24 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 25 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 26 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 27 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 28 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 29 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LOO - Site: 30 - Complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cross-validation for Predictive Co-Correspondence Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: crossval(y = beetles, x = plants)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cross-validatory %fit of beetles to plants:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  COCA1   COCA2   COCA3   COCA4   COCA5   COCA6   COCA7   COCA8   COCA9  COCA10  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5.1     7.8     7.0     6.9     7.7     8.5     8.7     6.8     6.5     6.7  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> COCA11  COCA12  COCA13  COCA14  COCA15  COCA16  COCA17  COCA18  COCA19  COCA20  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5.8     3.5     2.7     2.0     2.5    -0.1    -2.1    -2.9    -2.9    -3.5  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> COCA21  COCA22  COCA23  COCA24  COCA25  COCA26  COCA27  COCA28  COCA29  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -4.2    -4.3    -4.8    -5.7    -8.1   -24.6   -29.2   -37.9   -39.4  </span>
<span class="r-in"><span><span class="co">## so 2 axes are sufficient</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## permutation test</span></span></span>
<span class="r-in"><span><span class="co">## (Testing the first 2 axes &amp; only 25 perms for speed.)</span></span></span>
<span class="r-in"><span><span class="va">bp.perm</span> <span class="op">&lt;-</span> <span class="fu">permutest</span><span class="op">(</span><span class="va">bp.pred</span>, permutations <span class="op">=</span> <span class="fl">25</span>, n.axes <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutations for axis: 1 - completed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutations for axis: 2 - completed</span>
<span class="r-in"><span><span class="va">bp.perm</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation test for predictive co-correspondence analysis:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: permutest.coca(x = bp.pred, permutations = 25, n.axes = 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation test results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Stat. Inertia    Fit  % fit P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> COCA 1 0.0890  5.6964 0.4658 8.1763    0.04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> COCA 2 0.0761  5.2306 0.3701 6.4973    0.19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Gavin L. Simpson, Cajo J.F. ter Braak, Andre P Schaffers, Ron Wehrens, Bjorn-Helge Mevik.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

