<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Modified version of Sijmen de Jong's SIMPLS — simpls • cocorresp</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Modified version of Sijmen de Jong's SIMPLS — simpls"><meta property="og:description" content="Fits a PLSR model with the SIMPLS algorithm, modified to
  allow a weighted analysis."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cocorresp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4-4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/cocorresp-intro.html">Introduction to Co-correspondence Analysis</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/gavinsimpson/cocorresp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Modified version of Sijmen de Jong's SIMPLS</h1>
    
    <div class="hidden name"><code>simpls.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits a PLSR model with the SIMPLS algorithm, modified to
  allow a weighted analysis.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">simpls</span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, <span class="va">ncomp</span>, stripped <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>X</dt>
<dd><p>a matrix of observations.  <code>NA</code>s and <code>Inf</code>s are not
    allowed.</p></dd>
 
  <dt>Y</dt>
<dd><p>a vector or matrix of responses.  <code>NA</code>s and <code>Inf</code>s
    are not allowed.</p></dd>
 
  <dt>ncomp</dt>
<dd><p>the number of components to be used in the
    modelling.</p></dd>

  <dt>stripped</dt>
<dd><p>logical.  If <code>TRUE</code> the calculations are stripped
    as much as possible for speed; this is meant for use with
    cross-validation or simulations when only the coefficients are
    needed.  Defaults to <code>FALSE</code>.</p></dd>

  <dt>...</dt>
<dd><p>other arguments.  Currently ignored.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function is a modified version of
  <code><a href="https://rdrr.io/pkg/pls/man/simpls.fit.html" class="external-link">simpls.fit</a></code> from package <code>pls</code>. Four
  modification have been made:</p><ol><li><p>The input matrices <code>X</code> and <code>Y</code> are not centered,</p></li>
<li><p>The scores (<code>tt</code> in the code) are not centered,</p></li>
<li><p>Added code to calculate the total variance in the <code>Y</code>
      matrix, <code>Ytotvar</code>, and the variance in <code>Y</code> accounted for
      by each PLS axis, <code>Yvar</code> (See Value below), and</p></li>
<li><p>Additional components are returned if argument <code>stripped</code>
    is <code>TRUE</code>.</p></li>
</ol><p>This function should not be called directly, but through
  the generic function <code><a href="coca.html">coca</a></code>.</p>
<p>SIMPLS is much faster than
  the NIPALS algorithm, especially when the number of X variables
  increases, but gives slightly different results in the case of
  multivariate Y. SIMPLS truly maximises the covariance criterion.
  According to de Jong, the standard PLS2 algorithms lie closer to
  ordinary least-squares regression where a precise fit is sought;
  SIMPLS lies closer to PCR with stable  predictions.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>A list containing the following components is returned:</p>
<dl><dt>coefficients</dt>
<dd><p>an array of regression coefficients for 1, ...,
    <code>ncomp</code> components.  The dimensions of <code>coefficients</code> are
    <code>c(nvar, npred, ncomp)</code> with <code>nvar</code> the number
    of <code>X</code> variables and <code>npred</code> the number of variables to be
    predicted in <code>Y</code>.</p></dd>

  <dt>scores</dt>
<dd><p>a matrix of scores.</p></dd>

  <dt>loadings</dt>
<dd><p>a matrix of loadings.</p></dd>

  <dt>Yscores</dt>
<dd><p>a matrix of Y-scores.</p></dd>

  <dt>Yloadings</dt>
<dd><p>a matrix of Y-loadings.</p></dd>

  <dt>projection</dt>
<dd><p>the projection matrix used to convert X to scores.</p></dd>

  <dt>Xmeans</dt>
<dd><p>a vector of means of the X variables.</p></dd>

  <dt>Ymeans</dt>
<dd><p>a vector of means of the Y variables.</p></dd>

  <dt>fitted.values</dt>
<dd><p>an array of fitted values.  The dimensions of
    <code>fitted.values</code> are <code>c(nobj, npred, ncomp)</code> with
    <code>nobj</code> the number samples and <code>npred</code> the number of
    Y variables.</p></dd>

  <dt>residuals</dt>
<dd><p>an array of regression residuals.  It has the same
    dimensions as <code>fitted.values</code>.</p></dd>

  <dt>Xvar</dt>
<dd><p>a vector with the amount of X-variance explained by each
    number of components.</p></dd>

  <dt>Yvar</dt>
<dd><p>a vector with the amount of Y-variance explained by each
    number of components.</p></dd>

  <dt>Xtotvar</dt>
<dd><p>Total variance in <code>X</code>.</p></dd>

  <dt>Ytotvar</dt>
<dd><p>Total variance in <code>Y</code>.</p></dd>


</dl><p>If <code>stripped</code> is <code>TRUE</code>, only the components</p>
<p></p>
<p><code>coefficients</code>, <code>Xmeans</code> and <code>Ymeans</code>, <code>Xvar</code> and</p>
<p></p>
<p><code>Yvar</code>, and <code>Xtotvar</code> and <code>Ytotvar</code> are returned.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>de Jong, S. (1993) SIMPLS: an alternative approach to partial least
  squares regression.  <em>Chemometrics and Intelligent Laboratory Systems</em>,
  <b>18</b>, 251--263.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Based on <code><a href="https://rdrr.io/pkg/pls/man/simpls.fit.html" class="external-link">simpls.fit</a></code> by Ron Wehrens and
  Bjorn-Helge Mevik, with simple modifications by Gavin L. Simpson.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="coca.html">coca</a></code></p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Gavin L. Simpson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

