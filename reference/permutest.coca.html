<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Permutation test for predictive co-correspondence analysis
  models — permutest.coca • cocorresp</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Permutation test for predictive co-correspondence analysis
  models — permutest.coca" />
<meta property="og:description" content="A permutation test for predictive co-correspondence analysis models to
  assess the significance of each CoCA ordination axes." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cocorresp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4-2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/cocorresp-intro.html">Introduction to Co-correspondence Analysis</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/gavinsimpson/cocorresp/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Permutation test for predictive co-correspondence analysis
  models</h1>
    
    <div class="hidden name"><code>permutest.coca.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A permutation test for predictive co-correspondence analysis models to
  assess the significance of each CoCA ordination axes.</p>
    </div>

    <pre class="usage"># S3 method for coca
permutest(x, R0 = NULL, permutations = 99,
               n.axes = x$n.axes, verbose = TRUE, ...)

&lt;!-- %\method{print}{permutest.coca}(x, digits = max(3, getOption("digits") - 3), \ldots) --&gt;

# S3 method for permutest.coca
summary(object, ...)

&lt;!-- %\method{print}{summary.permutest.coca}(x, digits = max(3, getOption("digits") - 3), \ldots) --&gt;</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>an object of class <code>"predcoca"</code>.</p></td>
    </tr>
    <tr>
      <th>R0</th>
      <td><p>row weights to use in the analysis. If missing, the
    default, these are determined from <code>x</code>.</p></td>
    </tr>
    <tr>
      <th>permutations</th>
      <td><p>the number of permutations to perform.</p></td>
    </tr>
    <tr>
      <th>n.axes</th>
      <td><p>The number of axes to test. Defaults to the number of
    axes stated in <code>x$n.axes</code>.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>if <code>TRUE</code>, the default, print information on the
    progress of the permutation test procedure.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>an object of class <code>"permutest.coca"</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>arguments to be passed to other methods.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>An alternative approach to cross-validation (see
  <code><a href='crossval.html'>crossval</a></code>) to select the number of axes to retain in a
  predictive co-correspondence analysis is to test the statistical
  significance of each ordination axis using permutation tests.</p>
<p>The test statistic used is the <em>F</em>-ratio based on the fit of the
  first axis to the response data (ter Braak and Smilauer 2002). The
  second and subsequent axes are tested by treating previous axes as
  co-variables.</p>
<p>To be precise, this approach does not test the significance of SIMPLS
  axes, but those of NIPALS-PLS axes (ter Braak and de Jong 1998).</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with the following components:</p>
<dt>pval </dt><dd><p>a vector of <em>P</em>-values for each ordination axis.</p></dd>
  <dt>permstat </dt><dd><p>a vector of values for the test statistic for each axis.</p></dd>
  <dt>total.inertia </dt><dd><p>the total inertia in the response matrix.</p></dd>
  <dt>inertia </dt><dd><p>a vector containing the <em>residualised</em>
    inertia. This is the total inertia in the response <em>after</em>
    removing the inertia explained by all previous axes. For the first
    CoCA axis this is, by definition, the total inertia in the
    response.</p></dd>
  <dt>fitax </dt><dd><p>a vector containing the amount of inertia in the
    response matrix explained by each ordination axis.</p></dd>
  <dt>pcent.fit </dt><dd><p>a vector containing the fit of each axis to the
    response as a percentage of the total inertia (variance).</p></dd>
  <dt>n.axes </dt><dd><p>the number of axes in the ordination.</p></dd>
  <dt>call </dt><dd><p>the matched call.</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
  
<p>ter Braak, C.J.F. and de Jong, S. (1998) The objective function of
  partial least squares regression. <em>Journal of Chemometrics</em>
  <b>12</b>, 41--54.</p>
<p>ter Braak, C.J.F and Schaffers, A.P. (2004) Co-Correspondence
  Analysis: a new ordination method to relate two community
  compositions. <em>Ecology</em> <b>85(3)</b>, 834--846.</p>
<p>ter Braak, C.J.F. and Smilauer, P. (2002) <em>Canoco reference manual
    and CanoDraw for Windows user's guide: software for canonical
    community ordination. Version 4.5</em>. New York: Microcomputer Power.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Gavin L. Simpson, based on Matlab code by C.J.F. ter Braak and
  A.P. Schaffers.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Argument <code>R0</code> is provided for compatibility with the original
  MATLAB code. The R usage paradigm makes this argument redundant in the
  current code and it may be invalid to supply different row weights
  (\(R_0\)) as <code>R0</code>. This argument will likely be removed in future
  versions.</p>
    <h2 class="hasAnchor" id="warning"><a class="anchor" href="#warning"></a>Warning</h2>

    <p>This function is <b>slow</b>. Beware setting argument
  <code>permutations</code> higher than the default. Determine how long it
  takes for the default 99 permutations to complete before going crazy
  and asking for thousands of permutations - you've been warned, have a
  good book to hand.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='coca.html'>coca</a></code>, for the model fitting function,
  <code><a href='crossval.html'>crossval</a></code>, for a leave-one-out cross-validation
  procedure, which is the preferred way to select axes in a predictive
  co-correspondence analysis.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \dontshow{</span>
<span class='fu'><a href='https://rdrr.io/r/base/warning.html'>suppressWarnings</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>RNGversion</a></span><span class='op'>(</span><span class='st'>"3.5.0"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>od</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>digits <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span>
<span class='co'># }</span>
<span class='co'>## load some data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>beetles</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>plants</span><span class='op'>)</span>

<span class='co'>## log transform the bettle data</span>
<span class='va'>beetles</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>beetles</span> <span class='op'>+</span> <span class='fl'>1</span><span class='op'>)</span>
<span class='co'>## predictive CoCA using SIMPLS and formula interface</span>
<span class='va'>bp.pred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='coca.html'>coca</a></span><span class='op'>(</span><span class='va'>beetles</span> <span class='op'>~</span> <span class='va'>.</span>, data <span class='op'>=</span> <span class='va'>plants</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Removed some species that contained no data in: beetles, plants </span></div><div class='input'>
<span class='co'>## should retain only the useful PLS components for a parsimonious model</span>
<span class='co'># \donttest{</span>
<span class='co'>## Leave-one-out crossvalidation - this takes a while</span>
<span class='fu'><a href='crossval.html'>crossval</a></span><span class='op'>(</span><span class='va'>beetles</span>, <span class='va'>plants</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>some species contain no data and were removed from data matrix y</span></div><div class='output co'>#&gt; <span class='message'>some species contain no data and were removed from data matrix x</span></div><div class='output co'>#&gt; LOO - Site: 1 - Complete
#&gt; LOO - Site: 2 - Complete
#&gt; LOO - Site: 3 - Complete
#&gt; LOO - Site: 4 - Complete
#&gt; LOO - Site: 5 - Complete
#&gt; LOO - Site: 6 - Complete
#&gt; LOO - Site: 7 - Complete
#&gt; LOO - Site: 8 - Complete
#&gt; LOO - Site: 9 - Complete
#&gt; LOO - Site: 10 - Complete
#&gt; LOO - Site: 11 - Complete
#&gt; LOO - Site: 12 - Complete
#&gt; LOO - Site: 13 - Complete
#&gt; LOO - Site: 14 - Complete
#&gt; LOO - Site: 15 - Complete
#&gt; LOO - Site: 16 - Complete
#&gt; LOO - Site: 17 - Complete
#&gt; LOO - Site: 18 - Complete
#&gt; LOO - Site: 19 - Complete
#&gt; LOO - Site: 20 - Complete
#&gt; LOO - Site: 21 - Complete
#&gt; LOO - Site: 22 - Complete
#&gt; LOO - Site: 23 - Complete
#&gt; LOO - Site: 24 - Complete
#&gt; LOO - Site: 25 - Complete
#&gt; LOO - Site: 26 - Complete
#&gt; LOO - Site: 27 - Complete
#&gt; LOO - Site: 28 - Complete
#&gt; LOO - Site: 29 - Complete
#&gt; LOO - Site: 30 - Complete</div><div class='output co'>#&gt; 
#&gt; Cross-validation for Predictive Co-Correspondence Analysis
#&gt; 
#&gt; Call: crossval(y = beetles, x = plants)
#&gt; 
#&gt; Cross-validatory %fit of beetles to plants:
#&gt; 
#&gt;  COCA1   COCA2   COCA3   COCA4   COCA5   COCA6   COCA7   COCA8   COCA9  COCA10  
#&gt;    5.1     7.8     7.0     6.9     7.7     8.5     8.7     6.8     6.5     6.7  
#&gt; COCA11  COCA12  COCA13  COCA14  COCA15  COCA16  COCA17  COCA18  COCA19  COCA20  
#&gt;    5.8     3.5     2.7     2.0     2.5    -0.1    -2.1    -2.9    -2.9    -3.5  
#&gt; COCA21  COCA22  COCA23  COCA24  COCA25  COCA26  COCA27  COCA28  COCA29  
#&gt;   -4.2    -4.3    -4.8    -5.7    -8.1   -24.6   -29.2   -37.9   -41.4  </div><div class='input'><span class='co'>## so 2 axes are sufficient</span>
<span class='co'># }</span>

<span class='co'>## permutation test</span>
<span class='co'>## (Testing the first 2 axes &amp; only 50 perms for speed.)</span>
<span class='va'>bp.perm</span> <span class='op'>&lt;-</span> <span class='fu'>permutest</span><span class='op'>(</span><span class='va'>bp.pred</span>, permutations <span class='op'>=</span> <span class='fl'>50</span>, n.axes <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Permutations for axis: 1 - completed
#&gt; Permutations for axis: 2 - completed</div><div class='input'><span class='va'>bp.perm</span>
</div><div class='output co'>#&gt; 
#&gt; Permutation test for predictive co-correspondence analysis:
#&gt; 
#&gt; Call: permutest.coca(x = bp.pred, permutations = 50, n.axes = 2)
#&gt; 
#&gt; Permutation test results:
#&gt; 
#&gt;         Stat. Inertia    Fit  % fit P-value
#&gt; COCA 1 0.0890  5.6964 0.4658 8.1763    0.02
#&gt; COCA 2 0.0761  5.2306 0.3701 6.4973    0.25
#&gt; </div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span><span class='va'>od</span><span class='op'>)</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Gavin L. Simpson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


